# 배포 체크리스트

## 배포 전 확인사항

### 1. 코드 품질

- [ ] 모든 린터 오류 수정 (`pnpm lint`)
- [ ] TypeScript 타입 오류 없음 (`pnpm build`)
- [ ] 콘솔 에러 및 경고 확인
- [ ] 사용하지 않는 코드 제거
- [ ] 주석 및 문서화 완료

### 2. 기능 테스트

- [ ] 회원가입/로그인 플로우 테스트
- [ ] 상품 탐색 플로우 테스트
- [ ] 장바구니 플로우 테스트
- [ ] 주문 및 결제 플로우 테스트
- [ ] 주문 내역 조회 플로우 테스트
- [ ] 404 페이지 테스트
- [ ] 에러 바운더리 테스트

### 3. 빌드 테스트

- [ ] 프로덕션 빌드 성공 (`pnpm build`)
- [ ] 빌드 경고 확인 및 해결
- [ ] 빌드 크기 확인 (과도한 번들 크기 체크)
- [ ] 정적 파일 생성 확인

### 4. 환경변수 설정

- [ ] 모든 필수 환경변수 확인
- [ ] Vercel 대시보드에 환경변수 설정 완료
- [ ] 환경변수 값 정확성 확인
- [ ] 프로덕션/프리뷰 환경 구분 확인

### 5. 데이터베이스

- [ ] Supabase 프로젝트 생성 완료
- [ ] 데이터베이스 스키마 적용 완료
- [ ] 마이그레이션 파일 확인
- [ ] RLS 정책 확인 (프로덕션에서는 검토 필요)
- [ ] Storage 버킷 생성 완료

### 6. 외부 서비스 연동

- [ ] Clerk 프로젝트 생성 완료
- [ ] Clerk + Supabase 통합 완료
- [ ] Toss Payments 테스트 모드 키 발급 완료
- [ ] 각 서비스 대시보드에서 설정 확인

---

## Vercel 배포 절차

### 1. Git 저장소 연결

- [ ] Vercel 계정 생성 또는 로그인
- [ ] GitHub/GitLab/Bitbucket 저장소 연결
- [ ] 프로젝트 선택 또는 새 프로젝트 생성

### 2. 프로젝트 설정

- [ ] Framework Preset: Next.js 선택
- [ ] Root Directory: `.` (기본값)
- [ ] Build Command: `pnpm build` (자동 감지)
- [ ] Output Directory: `.next` (자동 감지)
- [ ] Install Command: `pnpm install` (자동 감지)

### 3. 환경변수 설정

- [ ] `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY` 설정
- [ ] `CLERK_SECRET_KEY` 설정
- [ ] `NEXT_PUBLIC_SUPABASE_URL` 설정
- [ ] `NEXT_PUBLIC_SUPABASE_ANON_KEY` 설정
- [ ] `SUPABASE_SERVICE_ROLE_KEY` 설정
- [ ] `NEXT_PUBLIC_TOSS_PAYMENTS_CLIENT_KEY` 설정
- [ ] 각 환경변수에 대해 Production/Preview 환경 선택

### 4. 배포 실행

- [ ] **Deploy** 버튼 클릭
- [ ] 빌드 로그 확인
- [ ] 배포 완료 대기

---

## 배포 후 확인사항

### 1. 기본 동작 확인

- [ ] 홈페이지 접근 가능
- [ ] 모든 페이지 라우팅 정상
- [ ] 정적 파일 로딩 정상
- [ ] 이미지 로딩 정상

### 2. 인증 확인

- [ ] 회원가입 페이지 접근 가능
- [ ] 로그인 페이지 접근 가능
- [ ] 회원가입 성공
- [ ] 로그인 성공
- [ ] 로그아웃 성공
- [ ] 인증 보호 페이지 접근 제한 확인

### 3. 데이터베이스 연결 확인

- [ ] Supabase 연결 정상
- [ ] 데이터 조회 정상
- [ ] 데이터 생성 정상
- [ ] 데이터 수정 정상
- [ ] Storage 업로드/다운로드 정상

### 4. 결제 플로우 확인

- [ ] 결제위젯 로딩 정상
- [ ] 테스트 결제 진행 가능
- [ ] 결제 성공 처리 정상
- [ ] 결제 실패 처리 정상
- [ ] 주문 상태 업데이트 정상

### 5. 성능 확인

- [ ] Lighthouse 점수 확인
  - [ ] Performance: 80 이상
  - [ ] Accessibility: 90 이상
  - [ ] Best Practices: 90 이상
  - [ ] SEO: 90 이상
- [ ] 페이지 로딩 시간 확인 (< 3초)
- [ ] 이미지 최적화 확인

### 6. 반응형 디자인 확인

- [ ] 데스크톱 레이아웃 정상
- [ ] 태블릿 레이아웃 정상
- [ ] 모바일 레이아웃 정상
- [ ] 다크모드 정상 (있는 경우)

### 7. 에러 처리 확인

- [ ] 404 페이지 표시 정상
- [ ] 에러 바운더리 동작 정상
- [ ] 빈 상태 처리 정상
- [ ] 로딩 상태 처리 정상

---

## 모니터링 설정

### 1. 에러 모니터링 (선택사항)

- [ ] Sentry 또는 유사 서비스 연동
- [ ] 에러 알림 설정
- [ ] 에러 로그 확인

### 2. 성능 모니터링

- [ ] Vercel Analytics 활성화 (선택사항)
- [ ] Web Vitals 모니터링
- [ ] 사용자 행동 분석 (선택사항)

### 3. 로그 확인

- [ ] Vercel 대시보드에서 빌드 로그 확인
- [ ] 런타임 로그 확인
- [ ] 함수 로그 확인 (Server Actions, API Routes)

---

## 문제 해결

### 빌드 실패

1. 빌드 로그 확인
2. 환경변수 확인
3. 의존성 문제 확인 (`pnpm install` 재실행)
4. TypeScript 오류 확인

### 런타임 에러

1. 런타임 로그 확인
2. 환경변수 값 확인
3. 데이터베이스 연결 확인
4. 외부 서비스 연동 확인

### 성능 문제

1. Lighthouse 리포트 확인
2. 번들 크기 확인
3. 이미지 최적화 확인
4. 코드 스플리팅 확인

---

## 롤백 절차

### 자동 롤백

- Vercel은 자동으로 이전 배포로 롤백 가능
- 배포 목록에서 이전 배포 선택 → **Promote to Production**

### 수동 롤백

1. Vercel 대시보드 → 프로젝트 → **Deployments**
2. 이전 성공한 배포 선택
3. **Promote to Production** 클릭

---

## 배포 후 작업

- [ ] 도메인 설정 (필요한 경우)
- [ ] SSL 인증서 확인 (자동 설정됨)
- [ ] Google Analytics 설정 (선택사항)
- [ ] SEO 메타 태그 확인
- [ ] 소셜 미디어 공유 이미지 확인

---

## 체크리스트 완료

- [ ] 모든 항목 확인 완료
- [ ] 배포 일자 기록: ___________
- [ ] 배포 담당자: ___________
- [ ] 배포 버전/태그: ___________

---

## 참고 자료

- [Vercel 배포 가이드](https://vercel.com/docs/concepts/deployments/overview)
- [Next.js 배포 문서](https://nextjs.org/docs/app/building-your-application/deploying)
- [환경변수 가이드](./environment-variables.md)
- [E2E 테스트 체크리스트](../testing/e2e-checklist.md)

